@{
    ViewBag.Title = "Form";
    Layout = "~/Views/Shared/_Form.cshtml";
}
<script>
    var keyValue = $.request("keyValue");
    var F_ClassIds = $.request("F_ClassIds");
    var F_ClassId = $.request("F_ClassId");
    $(function () {
        initControl();
        if (!!keyValue) {
            $.ajax({
                url: "/ScheduleManage/Schedule_Class_Teachers/GetFormJson",
                data: { keyValue: keyValue, F_ClassIds: F_ClassIds },
                dataType: "json",
                async: false,
                success: function (data) {
                    $("#form1").formSerialize(data);
                    var classids = data.F_Teacher_ID.split(",");
                    for (var i = 0; i < classids.length; i++)
                        $('#' + classids[i]).prop('checked', true)
                }
            });
        }

    });

    function initControl()
    {
        $('#F_Teacher_ID').bindCheckBox({
            url: "/ScheduleManage/Schedule_Class_Teachers/GetSelectJson?keyValue=" + keyValue,
            id: "id",
            text: "text",
            name: "F_Teacher_ID"
        });
        $("#F_SemesterId").bindSelect({
            url: "/SchoolManage/School_Semester/GetGridSelect",
            id: "F_Id",
            text: "F_Name"
        });
    }

    function submitForm(callback) {
        if (!$('#form1').formValid()) {
            return false;
        }
        if (keyValue == "") {
            $.modalAlert("请选择科目！", "warning");
            return;
        }
        var vals = "";
        $('input:checkbox:checked').each(function (index, item) {
            vals += $(this).val() + ",";
        });

        var postData = { F_CourseTime: $("#F_CourseTime").val(), F_RepeatCount: $("#F_RepeatCount").val(), F_CourseId: keyValue, F_ClassIds: F_ClassIds, F_TeacherIds: vals, F_ClassQTY: $("#F_ClassQTY").val(), ClassId: F_ClassId, F_SemesterId: $("#F_SemesterId").val() };
        $.loading(true, "正在处理...");
        $.submitForm({
            url: "/ScheduleManage/Schedule_Class_Teachers/Submit",
            param: postData,
            success: function () {
                $.loading(false)
                callback();
            }
        })
    }
</script>
<form id="form1">
    <div style="padding-top: 30px; margin-right: 40px;">
        <table class="form">
            <tr>
                <th class="formTitle">开班数</th>
                <td class="formValue">
                    <input id="F_ClassQTY" name="F_ClassQTY" type="text" class="form-control required" />
                </td>
            </tr>
            <tr>
                <th class="formTitle">学期</th>
                <td class="formValue">
                    <select id="F_SemesterId" name="F_SemesterId" class="form-control required">
                        <option value="">选择学期</option>
                    </select>
                </td>
            </tr>
            <tr>
                <th class="formTitle">教师</th>
                <td  class="formValue" id="F_Teacher_ID"></td>
            </tr>
            <tr>
                <th class="formTitle">教学课时</th>
                <td class="formValue">
                    <input id="F_CourseTime" name="F_CourseTime" type="text" class="form-control required" />
                </td>
            </tr>
            <tr>
                <th class="formTitle">连课次数</th>
                <td class="formValue">
                    <input id="F_RepeatCount" name="F_RepeatCount" value="0" type="text" class="form-control required" />
                </td>
            </tr>
        </table>
    </div>
</form>