@{
    ViewBag.Title = "Form";
    Layout = "~/Views/Shared/_Form.cshtml";
}
<script>
    var keyValue = $.request("keyValue");
    var keyText = $.request("keyText");
    $(function () {
        $("#F_SemesterId").bindSelect({
            url: "/SchoolManage/School_Semester/GetGridSelect",
            id: "F_Id",
            text: "F_Name"
        });
        $("#F_Year").bindSelect({
            dictionary: 'F_Year',
            displayBlank: false
        });
        $("#F_Divis_ID").bindSelect({
            url: "/SystemManage/Organize/GetSelectJsonByCategoryId?keyword=Division",
        });

        $("#F_Divis_ID").change(function () {
            changeTeacher();
        });

        //$("#F_GradeId").change(function () {
        //    changeCourse();
        //});
        //$("#F_CourseId").change(function () {
        //    changeTeacher();
        //});
        //$.addRequired('#form1');
        if (!!keyValue) {
            $.ajax({
                url: "/ScheduleManage/School_Timetable_Rule/GetFormJson",
                data: { keyValue: keyValue },
                dataType: "json",
                async: false,
                success: function (data) {
                    $("#F_Teacher").val(keyText);
                    $("#form1").formSerialize(data)
                }
            });
        }

    });

    //function changeDivis() {
    //    $("#F_GradeId").find("option").remove();
    //    $("#F_GradeId").bindSelect({
    //        url: "/SystemManage/Organize/GetSelectJsonByCategoryId?keyword=Grade&parentId=" + $("#F_Divis_ID").val(),
    //    });
    //    changeCourse();
    //}

    //function changeCourse() {
    //    $("#F_CourseId").bindSelect({
    //        url: "/SchoolManage/School_Grade_Course/GetCourseSelectJson?Grade_ID=" + $("#F_GradeId").val(),
    //        id: "F_Id",
    //        text: "F_Name"
    //    });
    //}

    function changeTeacher()
    {
        $('#F_DTeacher_ID').html('');
        $('#F_DTeacher_ID').bindCheckBox({
            url: "/SchoolManage/School_Teachers/GetDivisTeacher?F_Divis_ID=" + $("#F_Divis_ID").val(),
            id: "F_Id",
            text: "F_Name",
            name: "F_DTeacher_ID"
        });
    }

    function submitForm(callback) {
        //if (!$('#form1').formValid()) {
        //    return false;
        //}
        if (keyValue == "")
        {
            $.modalAlert("复制的源教师不能为空！", "warning");
            return;
        }
        var vals = "";
        $('input:checkbox:checked').each(function (index, item) {
            vals += $(this).val() + ",";
        });
        if (vals == "") {
            $.modalAlert("复制的目标教师不能为空！", "warning");
            return;
        }
        var F_Semester = $.request("F_SemesterId");
        var F_Divis = $.request("F_Divis_ID");
        var F_Year = $.request("F_Year");
        var postData = { F_Id: keyValue, F_DTeacherIds: vals, F_Semester: F_Semester, F_Divis: F_Divis,  F_Year: F_Year };
        $.loading(true, "正在处理...");
        $.submitForm({
            url: "/ScheduleManage/School_Timetable_Rule/SubmitCopy",
            param: postData,
            success: function () {
                $.loading(false)
                callback();
            }
        })
    }
</script>
<form id="form1">
    <div style="padding-top: 30px; margin-right: 40px;">
        <table class="form">
            <tr>
                <th class="formTitle">教师</th>
                <td class="formValue">
                    <input id="F_Teacher" name="F_Teacher" type="text" class="form-control " readonly="readonly" />
                </td>
            </tr>
            <tr>
                <th class="formTitle">年度：</th>
                <td class="formValue">
                    <select id="F_Year" name="F_Year" class="form-control required">
                        <option value="">选择年度</option>
                    </select>
                </td>
            </tr>
            <tr>
                <th class="formTitle">学期：</th>
                <td class="formValue">
                    <select id="F_SemesterId" name="F_SemesterId" class="form-control required">
                        <option value="">选择学期</option>
                    </select>
                </td>
            </tr>
            <tr>
                <th class="formTitle">学部：</th>
                <td class="formValue">
                    <select id="F_Divis_ID" name="F_Divis_ID" class="form-control required">
                        <option value="">选择学部</option>
                    </select>
                </td>
            </tr>
            @*<tr>
                <th class="formTitle">年级：</th>
                <td class="formValue">
                    <select id="F_GradeId" name="F_GradeId" class="form-control required">
                        <option value="">选择年级</option>
                    </select>
                </td>
            </tr>
            <tr>
                <th class="formTitle">科目：</th>
                <td class="formValue">
                    <select id="F_CourseId" name="F_CourseId" class="form-control required">
                        <option value="">选择科目</option>
                    </select>
                </td>
            </tr>*@
            <tr>
                <th class="formTitle">目标教师：</th>
                <td class="formValue" id="F_DTeacher_ID"></td>
            </tr>
        </table>
    </div>
</form>