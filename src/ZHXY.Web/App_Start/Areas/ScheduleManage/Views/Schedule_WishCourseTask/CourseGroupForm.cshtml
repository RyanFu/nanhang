@{
    ViewBag.Title = "Form";
    Layout = "~/Views/Shared/_Form.cshtml";
}
<script>
    var keyValue = $.request("keyValue");
    var F_GroupName = $.request("F_GroupName");
    $(function () {
        $("#F_GroupName").val(F_GroupName);
        initControl();
        if (!!keyValue) {
            $.ajax({
                url: "/ScheduleManage/Schedule_WishCourseTask/GetWishCourseGroupFormJson",
                data: { keyValue: keyValue },
                dataType: "json",
                async: false,
                success: function (data) {
                    $.each(data, function (i, item) {
                        $('#' + item.F_CourseGroupId).prop('checked', true)
                    })
                }
            });
        }

    });

    function initControl()
    {
        $('#F_CourseGroups').bindCheckBox({
            url: "/ScheduleManage/Schedule_CourseGroup/GetSelectJson",
            id: "F_Id",
            text: "F_GroupName",
            name: "F_CourseGroups"
        })
    }

    function submitForm() {
        if (!$('#form1').formValid()) {
            return false;
        }
        if (keyValue == "")
        {
            $.modalAlert("请选择班级！", "warning");
            return;
        }
        var vals = "";
        $('input:checkbox:checked').each(function (index, item) {
            vals += $(this).val() + ",";
        });

        var postData = { F_TaskId: keyValue, F_CourseGroupIds: vals };
        $.loading(true, "正在处理...");
        $.submitForm({
            url: "/ScheduleManage/Schedule_WishCourseTask/SetCourseGroup",
            param: postData,
            success: function () {
                $.loading(false)
            }
        })
    }
</script>
<form id="form1">
    <div style="padding-top: 30px; margin-right: 40px;">
        <table class="form">
            <tr>
                <th class="formTitle">任务名称</th>
                <td class="formValue">
                    <input id="F_GroupName" name="F_GroupName" type="text" class="form-control " readonly="readonly" />
                </td>
            </tr>
            <tr>
                <th class="formTitle">预选科目</th>
                <td  class="formValue" id="F_CourseGroups"></td>
            </tr>
        </table>
    </div>
</form>